<form class="{{cssClass}} {{actor.type}} npc-stat-block flexcol" autocomplete="off">

  {{!-- NPC Stat Block Header --}}
  <header class="npc-header">
    <div class="npc-title-section">
      <h1 class="npc-name"><input name="name" type="text" value="{{actor.name}}" placeholder="NPC Name"/></h1>
      <div class="npc-subtitle">
        <input type="text" name="system.attributes.size" value="{{system.attributes.size}}" placeholder="Size" class="size-input"/>
        <input type="text" name="system.attributes.type" value="{{system.attributes.type}}" placeholder="Type" class="type-input"/>
        <span class="separator">,</span>
        <input type="text" name="system.attributes.alignment" value="{{system.attributes.alignment}}" placeholder="Alignment" class="alignment-input"/>
      </div>
    </div>
    <img class="npc-portrait" src="{{actor.img}}" data-edit="img" title="{{actor.name}}"/>
  </header>

  {{!-- Stat Block Body --}}
  <section class="npc-stat-block-body">

    {{!-- Defense Section --}}
    <div class="stat-block-section">
      <div class="stat-line">
        <span class="stat-label">{{localize "Polaris.NPC.Armor"}}:</span>
        <input type="number" name="system.defense.armor" value="{{system.defense.armor}}" data-dtype="Number" class="inline-input"/>
      </div>
      <div class="stat-line">
        <span class="stat-label">{{localize "Polaris.NPC.Dodge"}}:</span>
        <input type="number" name="system.defense.dodge" value="{{system.defense.dodge}}" data-dtype="Number" class="inline-input"/>
      </div>
      <div class="stat-line">
        <span class="stat-label">{{localize "Polaris.NPC.Health"}}:</span>
        <input type="number" name="system.health.value" value="{{system.health.value}}" data-dtype="Number" class="inline-input"/>
        <span>/</span>
        <input type="number" name="system.health.max" value="{{system.health.max}}" data-dtype="Number" class="inline-input"/>
      </div>
    </div>

    <div class="stat-block-divider"></div>

    {{!-- Movement Section --}}
    <div class="stat-block-section">
      <div class="stat-line">
        <span class="stat-label">{{localize "Polaris.NPC.Movement"}}:</span>
        <input type="text" name="system.movement.ground" value="{{system.movement.ground}}" placeholder="6m" class="inline-input"/>
        <input type="text" name="system.movement.other" value="{{system.movement.other}}" placeholder="Other" class="inline-input-wide"/>
      </div>
    </div>

    <div class="stat-block-divider"></div>

    {{!-- Abilities Section --}}
    <div class="stat-block-section abilities-section">
      <div class="abilities-grid">
        {{#each system.abilities as |value key|}}
          <div class="ability-stat">
            <span class="ability-name">{{key}}</span>
            <input type="number" name="system.abilities.{{key}}" value="{{value}}" data-dtype="Number" class="ability-input"/>
            <span class="ability-mod">({{numberFormat (floor (subtract value 10) 2) decimals=0 sign=true}})</span>
          </div>
        {{/each}}
      </div>
    </div>

    <div class="stat-block-divider"></div>

    {{!-- Skills Section --}}
    <div class="stat-block-section">
      <div class="stat-line">
        <span class="stat-label">{{localize "Polaris.NPC.Skills"}}:</span>
        <textarea name="system.skills" rows="2" placeholder="{{localize 'Polaris.NPC.SkillsPlaceholder'}}">{{system.skills}}</textarea>
      </div>
    </div>

    <div class="stat-block-divider"></div>

    {{!-- Special Abilities --}}
    <div class="stat-block-section special-abilities">
      <h3 class="section-header">{{localize "Polaris.NPC.SpecialAbilities"}}</h3>
      {{#each system.specialAbilities as |ability index|}}
        <div class="special-ability-item">
          <div class="ability-header">
            <input type="text" name="system.specialAbilities.{{index}}.name" value="{{ability.name}}" placeholder="{{localize 'Polaris.NPC.AbilityName'}}" class="ability-name-input"/>
            <button type="button" class="ability-delete" data-index="{{index}}" data-type="specialAbilities"><i class="fas fa-trash"></i></button>
          </div>
          <textarea name="system.specialAbilities.{{index}}.description" rows="2" placeholder="{{localize 'Polaris.NPC.AbilityDescription'}}">{{ability.description}}</textarea>
        </div>
      {{/each}}
      <button type="button" class="add-ability" data-type="specialAbilities"><i class="fas fa-plus"></i> {{localize "Polaris.NPC.AddAbility"}}</button>
    </div>

    <div class="stat-block-divider"></div>

    {{!-- Attacks Section --}}
    <div class="stat-block-section attacks-section">
      <h3 class="section-header">{{localize "Polaris.NPC.Attacks"}}</h3>
      {{#each system.attacks as |attack index|}}
        <div class="attack-item">
          <div class="attack-header">
            <input type="text" name="system.attacks.{{index}}.name" value="{{attack.name}}" placeholder="{{localize 'Polaris.NPC.AttackName'}}" class="attack-name-input"/>
            <select name="system.attacks.{{index}}.type" data-dtype="String">
              {{#select attack.type}}
              <option value="Melee">{{localize "Polaris.NPC.Melee"}}</option>
              <option value="Ranged">{{localize "Polaris.NPC.Ranged"}}</option>
              {{/select}}
            </select>
            <button type="button" class="attack-delete" data-index="{{index}}"><i class="fas fa-trash"></i></button>
          </div>
          <div class="attack-details">
            <div class="attack-field">
              <label>{{localize "Polaris.NPC.AttackBonus"}}:</label>
              <input type="number" name="system.attacks.{{index}}.bonus" value="{{attack.bonus}}" data-dtype="Number" class="small-input"/>
            </div>
            <div class="attack-field">
              <label>{{localize "Polaris.NPC.Damage"}}:</label>
              <input type="text" name="system.attacks.{{index}}.damage" value="{{attack.damage}}" placeholder="2d6+3" class="medium-input"/>
            </div>
            <div class="attack-field">
              <label>{{localize "Polaris.NPC.DamageType"}}:</label>
              <input type="text" name="system.attacks.{{index}}.damageType" value="{{attack.damageType}}" placeholder="Slashing" class="medium-input"/>
            </div>
            <div class="attack-field">
              <label>{{localize "Polaris.NPC.Range"}}:</label>
              <input type="text" name="system.attacks.{{index}}.range" value="{{attack.range}}" placeholder="5m" class="small-input"/>
            </div>
          </div>
          <textarea name="system.attacks.{{index}}.description" rows="2" placeholder="{{localize 'Polaris.NPC.AttackDescription'}}">{{attack.description}}</textarea>
          <button type="button" class="attack-roll rollable" data-index="{{index}}" data-roll="1d20+{{attack.bonus}}" data-label="{{attack.name}}">
            <i class="fas fa-dice-d20"></i> {{localize "Polaris.NPC.RollAttack"}}
          </button>
        </div>
      {{/each}}
      <button type="button" class="add-attack"><i class="fas fa-plus"></i> {{localize "Polaris.NPC.AddAttack"}}</button>
    </div>

    <div class="stat-block-divider"></div>

    {{!-- Actions --}}
    <div class="stat-block-section">
      <h3 class="section-header">{{localize "Polaris.NPC.Actions"}}</h3>
      <textarea name="system.actions" rows="3" placeholder="{{localize 'Polaris.NPC.ActionsPlaceholder'}}">{{system.actions}}</textarea>
    </div>

    <div class="stat-block-divider"></div>

    {{!-- Reactions --}}
    <div class="stat-block-section">
      <h3 class="section-header">{{localize "Polaris.NPC.Reactions"}}</h3>
      <textarea name="system.reactions" rows="2" placeholder="{{localize 'Polaris.NPC.ReactionsPlaceholder'}}">{{system.reactions}}</textarea>
    </div>

    <div class="stat-block-divider"></div>

    {{!-- Notes --}}
    <div class="stat-block-section">
      <h3 class="section-header">{{localize "Polaris.NPC.Notes"}}</h3>
      <textarea name="system.notes" rows="3" placeholder="{{localize 'Polaris.NPC.NotesPlaceholder'}}">{{system.notes}}</textarea>
    </div>

  </section>
</form>

